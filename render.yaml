services:
  - type: web
    name: waha-gemini-assistant
    env: python
    region: oregon
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: python main.py
    envVars:
      - key: SPOTIFY_CLIENT_ID
        fromSecret: SPOTIFY_CLIENT_ID
      - key: SPOTIFY_SECRET
        fromSecret: SPOTIFY_SECRET
      - key: SPOTIFY_REDIRECT_URI
        value: http://localhost:8888/callback
      - key: WAHA_URL
        fromSecret: WAHA_URL
      - key: WAHA_API_KEY
        fromSecret: WAHA_API_KEY
      - key: WAHA_SESSION
        value: default
      - key: GEMINI_API_KEY
        fromSecret: GEMINI_API_KEY
      - key: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/secrets/credentials.json
    secrets:
      - name: SPOTIFY_CLIENT_ID
      - name: SPOTIFY_SECRET
      - name: WAHA_API_KEY
      - name: GEMINI_API_KEY
    autoDeploy: true

  - type: web
    name: waha-service
    env: docker
    region: oregon
    plan: free
    dockerfilePath: Dockerfile
    envVars:
      - key: WAHA_API_KEY
        fromSecret: WAHA_API_KEY
      - key: WAHA_SESSION
        value: default
    autoDeploy: true
